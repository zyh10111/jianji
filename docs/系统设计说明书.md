# 简记（NoteEase）—— 智能语音笔记 App

## 系统设计说明书

---

## 1. 系统概述

### 1.1 系统简介
简记（NoteEase）是一款基于 React Native + Expo 开发的跨平台移动应用，主要功能是通过语音转文字技术帮助用户快速创建和管理笔记。

### 1.2 设计目标
- 提供流畅的用户体验
- 模块化、可扩展的架构设计
- 清晰的代码结构
- 易于维护和升级

---

## 2. 系统架构设计

### 2.1 总体架构

```
┌─────────────────────────────────────────┐
│           用户界面层 (UI Layer)          │
│  HomeScreen | CreateNoteScreen          │
│  NoteDetailScreen | SearchScreen        │
└─────────────────────────────────────────┘
                    │
┌─────────────────────────────────────────┐
│         业务逻辑层 (Service Layer)       │
│  noteService | voiceService             │
│  syncService | exportService            │
└─────────────────────────────────────────┘
                    │
┌─────────────────────────────────────────┐
│         数据存储层 (Storage Layer)       │
│     AsyncStorage (本地存储)              │
│     云端API (模拟实现)                   │
└─────────────────────────────────────────┘
```

### 2.2 架构说明

#### 2.2.1 用户界面层
- **职责**：展示数据和接收用户输入
- **组件**：
  - `HomeScreen`：首页，展示笔记列表
  - `CreateNoteScreen`：创建/编辑笔记页面
  - `NoteDetailScreen`：笔记详情页面
  - `SearchScreen`：搜索页面

#### 2.2.2 业务逻辑层
- **职责**：处理业务逻辑和数据操作
- **服务**：
  - `noteService.js`：笔记CRUD操作
  - `voiceService.js`：语音识别和智能分类
  - `syncService.js`：数据同步
  - `exportService.js`：导出和分享

#### 2.2.3 数据存储层
- **职责**：数据持久化
- **实现**：
  - AsyncStorage：本地数据存储
  - 云端API：模拟实现（可接入真实后端）

### 2.3 技术栈

| 层级 | 技术/工具 |
|------|----------|
| 框架 | React Native + Expo |
| 语言 | JavaScript (ES6+) |
| 导航 | React Navigation |
| 存储 | AsyncStorage |
| 语音 | Expo AV (录音) |
| UI组件 | React Native 原生组件 |
| 状态管理 | React Hooks (useState, useEffect) |

---

## 3. UI/UX 设计

### 3.1 设计原则
- **简洁性**：界面简洁，避免冗余
- **一致性**：统一的设计语言和交互模式
- **易用性**：操作直观，学习成本低
- **美观性**：现代化的设计风格

### 3.2 色彩方案

| 用途 | 颜色代码 | 说明 |
|------|---------|------|
| 主色调 | #4A90E2 | 蓝色，用于主要按钮和强调 |
| 学习分类 | #4CAF50 | 绿色 |
| 生活分类 | #FF9800 | 橙色 |
| 工作分类 | #2196F3 | 蓝色 |
| 灵感分类 | #9C27B0 | 紫色 |
| 其他分类 | #9E9E9E | 灰色 |
| 背景色 | #F5F5F5 | 浅灰色 |
| 文字主色 | #333333 | 深灰色 |
| 文字次色 | #666666 | 中灰色 |
| 文字辅助 | #999999 | 浅灰色 |

### 3.3 页面设计

#### 3.3.1 首页（HomeScreen）
**布局结构**：
```
┌─────────────────────────┐
│    导航栏（简记）        │
├─────────────────────────┤
│  搜索 | 同步 | 导出      │
├─────────────────────────┤
│                         │
│  笔记卡片列表            │
│  - 标题                  │
│  - 内容预览              │
│  - 分类标签              │
│  - 时间                  │
│                         │
├─────────────────────────┤
│              [+ 创建]    │
└─────────────────────────┘
```

**交互说明**：
- 点击笔记卡片：查看详情
- 长按笔记卡片：删除笔记
- 点击搜索：进入搜索页面
- 点击同步：同步到云端
- 点击导出：导出所有笔记
- 点击创建按钮：创建新笔记

#### 3.3.2 创建笔记页（CreateNoteScreen）
**布局结构**：
```
┌─────────────────────────┐
│    导航栏（创建笔记）    │
├─────────────────────────┤
│  标题输入框              │
├─────────────────────────┤
│  分类选择（横向滚动）    │
├─────────────────────────┤
│  内容输入框              │
│  [🎤 语音输入]           │
├─────────────────────────┤
│  标签输入                │
│  标签列表                │
├─────────────────────────┤
│      [保存笔记]          │
└─────────────────────────┘
```

**交互说明**：
- 点击分类：选择分类
- 点击语音输入：开始/停止录音
- 输入标签后点击添加：添加标签
- 点击标签：删除标签
- 点击保存：保存笔记

#### 3.3.3 笔记详情页（NoteDetailScreen）
**布局结构**：
```
┌─────────────────────────┐
│  导航栏（笔记详情）      │
│         编辑|分享|删除   │
├─────────────────────────┤
│  标题                    │
│  分类标签                │
├─────────────────────────┤
│  标签列表                │
├─────────────────────────┤
│  内容                    │
│                         │
├─────────────────────────┤
│  创建时间                │
│  更新时间                │
└─────────────────────────┘
```

#### 3.3.4 搜索页（SearchScreen）
**布局结构**：
```
┌─────────────────────────┐
│  搜索框                  │
├─────────────────────────┤
│  分类筛选（横向滚动）    │
├─────────────────────────┤
│  搜索结果列表            │
│  - 高亮匹配内容          │
│  - 笔记信息              │
│                         │
└─────────────────────────┘
```

### 3.4 原型图说明
由于本文档为文本格式，详细的UI原型图可以使用以下工具创建：
- Figma
- Sketch
- Adobe XD
- 手绘原型图

关键设计要点：
- 使用卡片式设计展示笔记
- 使用颜色标识不同分类
- 使用标签展示标签信息
- 使用FAB（Floating Action Button）作为创建按钮

---

## 4. 数据库设计

### 4.1 数据存储方式
本应用使用 AsyncStorage 进行本地数据存储，数据格式为 JSON。

### 4.2 ER图

```
┌─────────────┐
│   笔记 (Note)│
├─────────────┤
│ id (PK)     │
│ title       │
│ content     │
│ category    │
│ tags (数组) │
│ createdAt   │
│ updatedAt   │
└─────────────┘
```

### 4.3 表结构设计

#### 4.3.1 笔记表（Notes）

| 字段名 | 类型 | 说明 | 约束 |
|--------|------|------|------|
| id | String | 笔记唯一标识符 | 主键，必填 |
| title | String | 笔记标题 | 可选，默认"无标题" |
| content | String | 笔记内容 | 可选 |
| category | String | 分类 | 必填，默认"其他" |
| tags | Array<String> | 标签数组 | 可选，默认为空数组 |
| createdAt | String (ISO 8601) | 创建时间 | 必填 |
| updatedAt | String (ISO 8601) | 更新时间 | 必填 |

**分类枚举值**：
- 学习
- 生活
- 工作
- 灵感
- 其他

### 4.4 数据示例

```json
{
  "notes": [
    {
      "id": "1234567890123",
      "title": "学习React Native",
      "content": "今天学习了React Native开发，感觉很有意思。",
      "category": "学习",
      "tags": ["React Native", "学习", "重要"],
      "createdAt": "2024-01-01T10:00:00.000Z",
      "updatedAt": "2024-01-01T10:00:00.000Z"
    }
  ]
}
```

### 4.5 数据索引
- 按创建时间倒序排列（最新在前）
- 按分类筛选
- 按关键词搜索（标题、内容、标签）

---

## 5. 模块设计

### 5.1 模块划分

```
src/
├── screens/              # 页面组件
│   ├── HomeScreen.js
│   ├── CreateNoteScreen.js
│   ├── NoteDetailScreen.js
│   └── SearchScreen.js
├── services/             # 业务服务
│   ├── noteService.js    # 笔记服务
│   ├── voiceService.js   # 语音服务
│   └── syncService.js    # 同步服务
└── utils/                # 工具函数
    └── exportService.js  # 导出服务
```

### 5.2 核心模块说明

#### 5.2.1 noteService.js
**功能**：笔记的CRUD操作
**主要函数**：
- `getAllNotes()`：获取所有笔记
- `saveNote(note)`：保存笔记
- `deleteNote(noteId)`：删除笔记
- `getNoteById(noteId)`：根据ID获取笔记
- `searchNotes(query)`：搜索笔记
- `getCategories()`：获取分类列表

#### 5.2.2 voiceService.js
**功能**：语音识别和智能分类
**主要函数**：
- `speechToText(audioUri)`：语音转文字（模拟）
- `classifyContent(content)`：智能分类
- `extractTags(content)`：提取标签

#### 5.2.3 syncService.js
**功能**：数据同步
**主要函数**：
- `syncToCloud(notes)`：同步到云端
- `syncFromCloud()`：从云端同步
- `checkSyncStatus()`：检查同步状态

#### 5.2.4 exportService.js
**功能**：导出和分享
**主要函数**：
- `exportNoteAsText(note)`：导出单个笔记
- `shareNote(note)`：分享笔记
- `exportAllNotes(notes)`：导出所有笔记

---

## 6. 接口设计

### 6.1 内部接口

#### 6.1.1 noteService 接口
```javascript
// 获取所有笔记
getAllNotes(): Promise<Array<Note>>

// 保存笔记
saveNote(note: Note): Promise<Note>

// 删除笔记
deleteNote(noteId: string): Promise<boolean>

// 根据ID获取笔记
getNoteById(noteId: string): Promise<Note | null>

// 搜索笔记
searchNotes(query: string): Promise<Array<Note>>

// 获取分类列表
getCategories(): Array<string>
```

#### 6.1.2 voiceService 接口
```javascript
// 语音转文字
speechToText(audioUri: string): Promise<{text: string, confidence: number}>

// 智能分类
classifyContent(content: string): string

// 提取标签
extractTags(content: string): Array<string>
```

### 6.2 外部接口（模拟）

#### 6.2.1 云端同步API（模拟）
```javascript
// 同步到云端
POST /api/notes/sync
Body: { notes: Array<Note> }
Response: { success: boolean, synced: number }

// 从云端获取
GET /api/notes
Response: { notes: Array<Note> }
```

---

## 7. 安全设计

### 7.1 数据安全
- 本地数据存储在设备本地（AsyncStorage）
- 敏感数据不进行明文存储
- 云端同步需要身份验证（实际实现时）

### 7.2 权限管理
- 麦克风权限：语音录制需要
- 文件系统权限：导出功能需要
- 网络权限：同步功能需要

### 7.3 错误处理
- 友好的错误提示
- 异常捕获和处理
- 数据备份机制（可选）

---

## 8. 性能优化

### 8.1 代码优化
- 使用 React.memo 优化组件渲染
- 使用 useCallback 和 useMemo 优化函数和值
- 虚拟列表（FlatList）优化长列表

### 8.2 数据优化
- 按需加载数据
- 数据缓存机制
- 异步操作避免阻塞UI

### 8.3 用户体验优化
- 加载状态提示
- 下拉刷新
- 流畅的动画效果

---

## 9. 扩展性设计

### 9.1 功能扩展
- 支持多媒体笔记（图片、音频）
- 支持Markdown格式
- 支持协作功能
- 支持更多分类和标签

### 9.2 技术扩展
- 接入真实语音识别API
- 接入真实后端API
- 支持离线模式
- 支持数据加密

---

## 10. 测试设计

### 10.1 单元测试
- 服务层函数测试
- 工具函数测试

### 10.2 集成测试
- 页面交互测试
- 数据流测试

### 10.3 用户测试
- 功能测试
- 可用性测试
- 性能测试

---

**文档版本**：v1.0  
**创建日期**：2024年  
**最后更新**：2024年
