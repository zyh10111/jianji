# 网络问题解决方案

本文档说明如何解决EAS Build构建时的网络连接问题。

---

## 错误：Failed to upload the project tarball to EAS Build

### 错误信息

```
Failed to upload the project tarball to EAS Build
Reason: request to https://storage.googleapis.com/... failed, reason: read ECONNRESET
Failed to upload metadata to EAS Build
Reason: request to https://storage.googleapis.com/... failed, reason: read ECONNRESET
```

### 原因

这个错误通常是因为：

1. **网络连接不稳定**：上传过程中网络中断
2. **无法访问Google服务**：EAS Build使用Google Cloud Storage，在中国大陆可能无法访问
3. **防火墙限制**：公司或学校网络可能阻止访问Google服务
4. **上传超时**：文件较大时上传时间过长导致超时

### 解决方案

#### 方法一：使用VPN（推荐，如果在国内）

**如果在中国大陆**，推荐使用VPN：

1. **连接VPN**
   - 使用可靠的VPN服务
   - 确保VPN连接稳定
   - 推荐使用全局代理模式

2. **重新运行构建命令**
   ```bash
   eas build --platform android --profile preview
   ```

3. **如果仍然失败**
   - 尝试不同的VPN节点
   - 检查VPN速度
   - 确保VPN连接稳定

#### 方法二：使用移动热点

有时移动网络比WiFi更稳定：

1. **断开WiFi，连接手机热点**
2. **重新运行构建命令**
   ```bash
   eas build --platform android --profile preview
   ```

#### 方法三：重试构建

网络问题可能是临时的，可以重试：

1. **直接重新运行构建命令**
   ```bash
   eas build --platform android --profile preview
   ```

2. **如果多次失败**
   - 等待一段时间后重试
   - 检查网络连接状态
   - 尝试使用VPN

#### 方法四：检查网络设置

1. **检查网络连接**
   - 确保网络连接正常
   - 测试是否能访问 expo.dev
   - 测试是否能访问 storage.googleapis.com

2. **检查防火墙/代理设置**
   - 如果使用公司/学校网络，检查是否阻止Google服务
   - 如果有代理，确保代理配置正确
   - 尝试使用个人网络

#### 方法五：使用代理

如果有可用的代理：

1. **设置HTTP代理**
   ```bash
   # 设置代理（示例）
   set HTTP_PROXY=http://proxy.example.com:8080
   set HTTPS_PROXY=http://proxy.example.com:8080
   
   # 然后运行构建
   eas build --platform android --profile preview
   ```

2. **清除代理（如果需要）**
   ```bash
   unset HTTP_PROXY
   unset HTTPS_PROXY
   ```

---

## 常见网络错误

### 1. read ECONNRESET（连接重置）

**原因**：连接被中断

**解决方案**：
- 使用VPN（如果在国内）
- 检查网络连接
- 重试构建

### 2. ETIMEDOUT（超时）

**原因**：连接超时

**解决方案**：
- 检查网络速度
- 使用更快的网络
- 使用VPN

### 3. Network error（网络错误）

**原因**：网络连接问题

**解决方案**：
- 检查网络连接
- 使用VPN
- 重试构建

---

## 推荐方案

### 对于中国大陆用户

**推荐步骤**：

1. **使用VPN**（最重要）
   - 连接VPN
   - 确保VPN稳定
   - 使用全局代理模式

2. **重新运行构建**
   ```bash
   eas build --platform android --profile preview
   ```

3. **如果VPN仍然失败**
   - 尝试不同的VPN服务
   - 尝试不同的VPN节点
   - 检查VPN速度

### 对于其他地区用户

**推荐步骤**：

1. **检查网络连接**
2. **重试构建**
3. **如果多次失败，检查网络设置**

---

## 预防措施

1. **使用稳定的网络**
   - 推荐使用家庭网络或移动热点
   - 避免使用公共WiFi
   - 避免使用不稳定的网络

2. **使用VPN（如果在国内）**
   - 使用可靠的VPN服务
   - 确保VPN连接稳定
   - 在构建前测试VPN连接

3. **选择合适的构建时间**
   - 避免网络高峰期
   - 选择网络稳定的时间段

---

## 其他提示

1. **构建过程需要网络**
   - EAS Build是云端构建服务
   - 需要上传代码到服务器
   - 需要下载构建结果

2. **上传时间**
   - 首次构建可能需要上传较多文件
   - 后续构建通常更快（使用缓存）
   - 上传时间取决于网络速度

3. **构建成功后可以离线**
   - 构建完成后可以下载APK
   - APK可以离线安装
   - 不需要持续网络连接

---

## 如果所有方法都失败

如果尝试了所有方法仍然无法上传：

1. **检查EAS服务状态**
   - 访问 https://status.expo.dev/
   - 确认EAS服务是否正常

2. **联系支持**
   - Expo社区：https://forums.expo.dev/
   - GitHub Issues：https://github.com/expo/expo/issues

3. **考虑其他方案**
   - 使用本地构建（需要Android开发环境）
   - 使用其他构建服务

---

**文档版本**：v1.0  
**最后更新**：2024年
